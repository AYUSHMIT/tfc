#!/usr/bin/env bash

# TFC - Onion-routed, endpoint secure messaging system
# Copyright (C) 2013-2021  Markus Ottela
#
# This file is part of TFC.
#
# TFC is free software: you can redistribute it and/or modify it under the terms
# of the GNU General Public License as published by the Free Software Foundation,
# either version 3 of the License, or (at your option) any later version.
#
# TFC is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
# without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
# PURPOSE. See the GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with TFC. If not, see <https://www.gnu.org/licenses/>.

# Installer configuration

INSTALL_DIR="/opt/tfc"


# ----------------------------------------------------------------------------------------

# PIP dependency file hashes
declare -A dependency_hashes
dependency_hashes['appdirs-1.4.4-py2.py3-none-any.whl']='8e6c1ea544013ea2567cda2d8b8c7b441bc50ac689aa7f95de67e3795aa083e9592c687d74fdbb37f5a75e0beab398fe47df5bced14ee9c204cfe5ecc364ef44'
dependency_hashes['appdirs-1.4.4.tar.gz']='8b0cdd9fd471d45b186aa47607691cf378dabd3edc7b7026a57bd6d6f57698e86f440818a5e23ba4288b35d6bb8cb6eb0106eae8aab09d8863ee15025d300883'
dependency_hashes['argon2_cffi-21.1.0-cp35-abi3-manylinux_2_5_x86_64.manylinux1_x86_64.whl']='865d30e27ee6efa46cfed30e4c90106ff36bb3686f7ff6277d29119aaed6777eca31271ee132090b111e7d2fa2705b362f20ce570c3f1aa990f1e526f8f3863b'
dependency_hashes['argon2_cffi-21.1.0-pp36-pypy36_pp73-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl']='bd631396fd6ee3021ebd3a79f67d5400d58a2ed980cece726848e163e3c8cb017e88a87ecd1260413fa75e0d99589312ca32067f64b192053079e100e557c3e7'
dependency_hashes['argon2_cffi-21.1.0-pp37-pypy37_pp73-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl']='b8eaa099d91168691b0a5bd214998cbd7fc6aff1ea2c12a407e58fecb9abf1b02b580f0e9045545c85e6c79ece48fccf9a35a22db3ec8faac942bfaa6386ab96'
dependency_hashes['argon2-cffi-21.1.0.tar.gz']='bbfebd2c075f360a6c1c187c0789be2aae7480b9398f36db7bdfe74f288d9e00b44a788918c54f4cc8bb1947136ab0493f61975de408c482a5131e2bf1a8f4d0'
dependency_hashes['backports.entry_points_selectable-1.1.0-py2.py3-none-any.whl']='3e1bb8c596b7e8de24eaa4a7360fc691ee2fcd8d106488a988c88ba18fd3d2bd2f4bf05aa88c24e855ffedceb1f0c7c2699556a214d7d7903e91ba5c30e1e8e2'
dependency_hashes['backports.entry_points_selectable-1.1.0.tar.gz']='86c794899cac2f916b36388fd071a619ef27743ac94f0bb058e6157d02481109088ed7891c7775c2f859b92150315acce9052b04ae000363c54af052fbf50ea7'
dependency_hashes['certifi-2021.10.8-py2.py3-none-any.whl']='7a456d168d763c3f47c630f3dbccdb1f7d9fb7a7b4fd4e3119a5cc7e781c4c87dbdb549c8974052cdf0a428b48441dbd4e6477c90f06680265cc0cdd7d73d0ae'
dependency_hashes['certifi-2021.10.8.tar.gz']='06dc41a471f16f6c52751854e82fb42011c9388651cff55761298b86ba437d431e6325ab039ef330f2b2c5f69f5ba43dc468e7ca3df205a8bb31468f43711fbe'
dependency_hashes['cffi-1.15.0-cp310-cp310-manylinux_2_12_i686.manylinux2010_i686.whl']='bed4a8b71bbcdac2a6e633fbff53d2587f4e032d2f6b8c4d40645bad73986d235a24c85c20d480d0cbad86e7658b3f9645742f315405687513dd14ec45262589'
dependency_hashes['cffi-1.15.0-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl']='b55677cce213b09209a3e461a9399821c905efa63ec8f8b4926f60ef5fd24eeebe28757e05b342214cf58e816ea66a6287a3904e8a2039b2f4872d50046514ec'
dependency_hashes['cffi-1.15.0-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='be1af77c50537760103735f9923b2487bfa5c1745ef8885eba900c5abfe64463dcffed12b2d0549de2c1ee3785457435e769dc99992d3d351f623e4e0b343258'
dependency_hashes['cffi-1.15.0-cp310-cp310-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl']='980fd4ee11c8244b76d33fc2e2bb5b1cb393e9f2124ae2189a7658fb63b8fe670bacdfe50a7fe5075d78e78ab61f4835e3d3f49e34cf22ebc4f3fd7cae8ad030'
dependency_hashes['cffi-1.15.0-cp310-cp310-manylinux_2_17_s390x.manylinux2014_s390x.whl']='7256b05ccf9d21916f5b9db7d8fa6a5a168813969e3f1b9881d9133dee554ccff3c64a989cb38b8de4834386cb9807527e9dc95e7bc2244a56dc2b4c56cfc3e4'
dependency_hashes['cffi-1.15.0-cp36-cp36m-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='a9d0e4341639f3e11f0d063edb3510d8c3f4fa1e3657f3f91f252a470ff951054579f1e6ed073910a863ab9556b0c927d23ed7c71946b6659ca4e86c1a3ec7d1'
dependency_hashes['cffi-1.15.0-cp36-cp36m-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl']='022658b602229d40cac30092c81f93ec2a04d5e75b72d9421fa404894a31cb48b35bd506b13c5573bab84fb55c06fa1321140855aed445fd7587bb829bfe6e70'
dependency_hashes['cffi-1.15.0-cp36-cp36m-manylinux_2_17_s390x.manylinux2014_s390x.whl']='9b9c9d6d336eb86e2711b813f442fe5156ab746431d5482ecc6033edf883cb3901abffa95e6dcf570385e90a0ef222a8c4b3737fdbeaa16ebbeec1fabb69522a'
dependency_hashes['cffi-1.15.0-cp36-cp36m-manylinux_2_5_i686.manylinux1_i686.whl']='d579472800178b6b13fae4275f019ce13a802ab9f26fdf5cbbc726a6aa12f33f91a1c5f40f9e2804ae40a7ebac87c0f405f70672ec8853403712a6ac839ff9bf'
dependency_hashes['cffi-1.15.0-cp36-cp36m-manylinux_2_5_x86_64.manylinux1_x86_64.whl']='280272d3bf1dc43b264879f39d6da00348b413bfa3d2f098d97deaff537f277d015e1fc1f3a7e0840999b9e692f384cfe0f98e40696e0f379385b1b71fd73fa3'
dependency_hashes['cffi-1.15.0-cp37-cp37m-manylinux_2_12_i686.manylinux2010_i686.whl']='1b2032e16ff59abed3c9f00a87617b20ec96cd45df008d9bbc6ea3df4e62fc9e080454114a5077a5b8421c30aa7dbedd1aa9a2512897f8f50633f960e474e0e1'
dependency_hashes['cffi-1.15.0-cp37-cp37m-manylinux_2_12_x86_64.manylinux2010_x86_64.whl']='316d430ff39b8029c357d10434ee9d94b74c563a39bd5e79afe997e8d6fadf4e755957ff69bfda69192a5abff2680f60dc0852df905f5962dd9f8cc403d6c853'
dependency_hashes['cffi-1.15.0-cp37-cp37m-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='d56a614754762f691ea6fbe866e1969809d7f6ad7723748fe48a6a317c8a85ab2187733b7bb2b41686d2296c39d0c4b63553e9f4efd657856fb4b8c2066dc0fa'
dependency_hashes['cffi-1.15.0-cp37-cp37m-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl']='e02f7f2a8cace1bc26a4f444e2033029a3b80765366e76f96d6450c4648e0f69dc1edcd6e99b7d9041e2ab42e7987001a47e91eaace107f014b453b1cb2bf199'
dependency_hashes['cffi-1.15.0-cp37-cp37m-manylinux_2_17_s390x.manylinux2014_s390x.whl']='a69a5d7e0474c14ccfb52f02b60b4ff997c93580eb1b9d36322dccab53eacb46bcbc06af30ec8ec152a887b39573161e49fb76452b2020c8a38379112996a334'
dependency_hashes['cffi-1.15.0-cp38-cp38-manylinux_2_12_i686.manylinux2010_i686.whl']='d4bb960c3f23b9ad99506a58784279119d0affea0a835177d32dd5ae8803f47c68fa153efd24ef0985369efd6504c8eddb2fbed78a7d64a3a0ef17b510387b36'
dependency_hashes['cffi-1.15.0-cp38-cp38-manylinux_2_12_x86_64.manylinux2010_x86_64.whl']='6c743a2cb497cfdad09f6b67f6db7ddbbcc841dd3b0db14520f4c612ecaa25b390cef51f66d5119e5b9d437f6083e75b023793b89d8e8ddce98d01f3bec6d38d'
dependency_hashes['cffi-1.15.0-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='f969af51df270b3188abde6af6e3bebaaef2d6bb9e981522742628ce9241bbd2d6bce1ca2d71e1e6929ae0e9b062596d343f7e5a84e7d233a9a47797aef82e60'
dependency_hashes['cffi-1.15.0-cp38-cp38-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl']='32f08420acf00de4f00d1c853a92f3a08e485a0fcc2ce4d2e1d56a47914108363dc556958ca15b5166682a654812ef17c38bfddca5c20fe3081c6cf84e055de8'
dependency_hashes['cffi-1.15.0-cp38-cp38-manylinux_2_17_s390x.manylinux2014_s390x.whl']='7a9bbf56f4a538fce282af93919d9970a0031bc682500fbef3606556047fe399fed54952bf43144f1a7e4cad3425456d00258d2c88afd8d8c219e892dc173842'
dependency_hashes['cffi-1.15.0-cp39-cp39-manylinux_2_12_i686.manylinux2010_i686.whl']='206e038ba08bc31c1e6457692f059d7e730b8eb74ebb123e53d8abe3798d50a09d6dacf1a1ec8f9cdf42b086e0fdc8ac42e63af72aa21f62c31aefbe5e09e0d6'
dependency_hashes['cffi-1.15.0-cp39-cp39-manylinux_2_12_x86_64.manylinux2010_x86_64.whl']='bdd59dff8b8de67f8dc88cc25d83443a46ed8f20695f6aaf0a9db2c8a229eb717c5c715e2ca4cb2a3e0780989e1e7c38325d3dfd4907f3e4e536a643ad3ee676'
dependency_hashes['cffi-1.15.0-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='228777c006537e75759681438b61d961bd79f610514f93da7f18412d15dc767f9ec33da9bc6feda55278b8d7ea57d0bf6da6eb2cf3cf8ad5731595ac8dd2fbd9'
dependency_hashes['cffi-1.15.0-cp39-cp39-manylinux_2_17_ppc64le.manylinux2014_ppc64le.whl']='576ba9e0d715666f9de0e8bb54af00726383f0dbbbf43de4efca9673d9d911ef26d33d5a78bf78d422dd5bcbb49f6ebc12ce6314cf11e26153992017ab9109b1'
dependency_hashes['cffi-1.15.0-cp39-cp39-manylinux_2_17_s390x.manylinux2014_s390x.whl']='e1abb268c8d2b88ca713fc39a48d78fded9735ee85b20360105d479bb6fb4b27b80e04cd1d5e9b46d31431d97441e602a40ced56795987afe40748ea9b72dc84'
dependency_hashes['cffi-1.15.0.tar.gz']='ee83efde6f77f4a0c5889088c4c208ed7b9071fe06dfc16a8d2396de07f78fe859e1e39866760198a9d700f3b7359e8715e8a3e4907feb81d3fc4b8dd0dbaca1'
dependency_hashes['chardet-4.0.0-py2.py3-none-any.whl']='cc8cdd5e73b4eace0131bbeaf6099e322ba5c2f827f26ad3316c674c60529d77f39f68d9fb83199ab78d16902021ab1ae58d74ab62d770cf95ceb804b9242e90'
dependency_hashes['chardet-4.0.0.tar.gz']='ebd7f420e1094445270db993f6373ffe7370419e002b0bb13299dc6c9b0f7c4e77b0f44f871fba6371e6869e7c86728514367db377e3137487a3acf50cb81e96'
dependency_hashes['charset_normalizer-2.0.7-py3-none-any.whl']='b763644a6c838ac4629ef03c4698b6062411bdcb772c67c101cf32bdc530f0a9a146651939850eab5db5fe01bf312aaca5cac2005114104e36da866cda7c9ccb'
dependency_hashes['charset-normalizer-2.0.7.tar.gz']='7096fa23fade52c8eee2577b87aa574deffe6f66e8986f71172f3b9212bd6c6fb17901cceab90144c9d07de8bc6f5e320497daa3d3f749f436788232d4cba088'
dependency_hashes['click-8.0.3-py3-none-any.whl']='dc19b22f7548a05c4656f78287ba198717eaff7ceb292de535b2dc8196b1dd067baa1d70d3ccfbb7274e59647c7e5313d4362e328e8757c9f2c7a939085cac13'
dependency_hashes['click-8.0.3.tar.gz']='f6dcda8014503bc3e5b3599a5ce870b6d927a67e62c3dc88cc7b193db9bede1f1242905e56128b51df12e61fb0c15909d028a7bcb466655a8e01357c121aacda'
dependency_hashes['cryptography-35.0.0-cp36-abi3-manylinux_2_12_x86_64.manylinux2010_x86_64.whl']='fcd6a833878420f1d68809f42710b03bf48e82df5d19e11ebfdc5c338ae691d3bdcb0f46fb7621ab10e5ac46b9b1c032a00e6d5051e068e3cc8744cf0f5b13fa'
dependency_hashes['cryptography-35.0.0-cp36-abi3-manylinux_2_17_aarch64.manylinux2014_aarch64.manylinux_2_24_aarch64.whl']='bec5518bab31a8636672e2544b53966ec45c21311ac5ea65e13c5f5e4201160f88be6b36b64ae77782f61ca8404266e16cd52d7c87aa83342eb949af5bb047af'
dependency_hashes['cryptography-35.0.0-cp36-abi3-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='e501067c62b353d9a24b2b499b5c9a5278d140754834f7b4174b69373ffdcf137d9de1b48e2ff12e435d1ea1c514ef92e220d0d37a126ed90f28462faf92a2b8'
dependency_hashes['cryptography-35.0.0-cp36-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='f9d2e929f0b4b6e062d1d42ac9368cfab35b1de1862f58abe1cf6e19b22744c49527dcd0bda5a8a6ab34d79b7f4e5e53b84d0dcadca9bbd4af0df83d92da0745'
dependency_hashes['cryptography-35.0.0-cp36-abi3-manylinux_2_24_x86_64.whl']='87c2700e4735f17142226e5aa737921887aa68253136fb2c9bba83285dab775b6ac7d707231fb183ac8891fd60d2d486be08f0b954d0a5e920cb586bc4b1aa74'
dependency_hashes['cryptography-35.0.0-cp36-abi3-musllinux_1_1_aarch64.whl']='8ece22bd07183d4c4d1132514962fad2361e1fc062b53618442e9abb65aa390ebfcdc0e5edcfc27bdb3dd35af8e6c8403cc2b53fb4c2476098313082a65c0592'
dependency_hashes['cryptography-35.0.0-cp36-abi3-musllinux_1_1_x86_64.whl']='5e61093f8c0c24e5204f1812040b2be9a9df80159f9d2b0dcfa6802425fc044f9af78a0d5b5314c5fd3afb675feb5c9baec4815b665b4b72642e76152f931f2b'
dependency_hashes['cryptography-35.0.0-pp36-pypy36_pp73-manylinux_2_12_x86_64.manylinux2010_x86_64.whl']='44ba6073107d95d9501c0a8521e84a83f5c9086d365a2c60a314b31e8a5271abed1096d4ca93de2a42b71c6f4a7db025bdb308ce69603edc145cb96e645cd5bf'
dependency_hashes['cryptography-35.0.0-pp36-pypy36_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='b155af36a8fc7cc5ae9792e5f060c76385e76882af68333e2b3ecfdd749dba4a0112a1cd49bbec70f77b321264145b2321883dcf86fcdddaae0f61782f872020'
dependency_hashes['cryptography-35.0.0-pp36-pypy36_pp73-manylinux_2_24_x86_64.whl']='e8f6b715b10744b1910ef99dfd1a65e9e296927de0897a91d5bfad0931029fa7c0b0ea0fd9eb481db17a6e0a338f176512a60f913f013ffda965fb72ad69148b'
dependency_hashes['cryptography-35.0.0-pp37-pypy37_pp73-manylinux_2_12_x86_64.manylinux2010_x86_64.whl']='d473bb070f8b0755127164e8c944db628083f13182a9518862d6b3edcf4d016afa1e0345c7383e17519c14301123fbf9d0a7cfccbad30d5d68308f698549ac84'
dependency_hashes['cryptography-35.0.0-pp37-pypy37_pp73-manylinux_2_17_x86_64.manylinux2014_x86_64.whl']='707a6b4abc6242a2385f7e47c06b440763c21757aefb9423a1d4cd51469c827e69f28e6bc44d6b67a0b0a23d62caaf408dc4dda40bffd40894da2adfc099c509'
dependency_hashes['cryptography-35.0.0-pp37-pypy37_pp73-manylinux_2_24_x86_64.whl']='563b4ba3a48de4505438ffada686500b7810849ba39848efa0ebe25eb8a5c911394257f9085d53a0b6f850fdcdd1271d98358223588cc791f96e557e2e69b6de'
dependency_hashes['cryptography-35.0.0.tar.gz']='447fd81ea82bd5875f14b3dca0fe6c1e8ebe661485252b00c3a19ab91bc0261289fbc59f9a22ba9317e8ba01f7f197c90ca6973f9d87a5d8851eeff2e1168d1d'
dependency_hashes['distlib-0.3.3-py2.py3-none-any.whl']='5dac94cf28e93820cd26093f63607a538e38f9e8fe8e45a8989e01694d98bf855e1ad9499296dab31401bd62943c01fe15fe87f2c30114fbccef974e98b6c6b5'
dependency_hashes['distlib-0.3.3.zip']='834ed7314b2c3aecaaa833a275aac9ae72feb27e62c4e712b30bb5ac526bd38d18756d51ca8c95015953dac7f0cfd7e60382c0a7bdf330d8a01602ccb7344f0d'
dependency_hashes['filelock-3.3.2-py3-none-any.whl']='b53f12a19fa34afb999de4f2db84098c1ec5aa1624c45d1a0225b351ea8aea64895c525a56c9472575cb7e2bbf939718f5e6e0d667c24f6ed94c4900c8d4d361'
dependency_hashes['filelock-3.3.2.tar.gz']='632b3c0f17c1c41f6d355e9599f1ddaeee51997f3b8679a2bae06dd55c6b27f65ac447813ecb6a128dd3882af21d3abfecfe94a74509a467d9cb99665fb7a7e2'
dependency_hashes['Flask-2.0.2-py3-none-any.whl']='b36c8d5f4936f33d033d3ea7ff008463a50723181531aa187529abc6b3c13a803f5bb3a23928d827fd6b16282cea57582ccc9f733595ce49fb64fd4c8c3d5262'
dependency_hashes['Flask-2.0.2.tar.gz']='341be4e453dd5f682e465af356ff85ffe76f52a62e529e6cd251f95199e73b0f93414af093f899f61721e9bb351f09972a433a55beacc972b5e577b86e003081'
dependency_hashes['idna-3.3-py3-none-any.whl']='797480f82a102bc41e86de2b19822047d5e551926f0c7ab80cfaf758f8938d585d0593115a9bafdae807114ebcbce65eccaaa2c629aaf00255f407deb7e5c343'
dependency_hashes['idna-3.3.tar.gz']='70b7cc8718e7d7899c75cfe476f044eae5a2fa03801fc9c12e3a092627ca943ffc4a578f9b8a55e181a11564835e125cfaaa577c02a6461dbb97366e620e53ad'
dependency_hashes['importlib_metadata-4.8.1-py3-none-any.whl']='e818691aef3cc566da0e031d588832be7a5b1b5ccffd9240cf8c1b1cf50efc3ee252048f9ce92d5d22d8510e80fb3b7dd91d4cdcfc2678ced1f1671b68bedab7'
dependency_hashes['importlib_metadata-4.8.1.tar.gz']='ad9ab435d4a49a12c9440d1d53cfc835fd889fee032db6ad1dded59b6e453f26ef97bca303e22d945124295ec7c50fa55837a13e7790dea01562a1724571f9fe'
dependency_hashes['itsdangerous-2.0.1-py3-none-any.whl']='93c1319854aad7614ed9c98cf94ff61ca3abb8719c79ebbfe3f07e741559e3e1db8b0ba137c688c8bb80f616438d18aff9e1ef62d2829d8dba4f1194582056eb'
dependency_hashes['itsdangerous-2.0.1.tar.gz']='bc1e51eb861c13b4e3c4c1c655a3b6f28e326d70db23679269d2bea84f0f8f94afd4fccecb745cf40f5a5956a14a336dfa42f0f5149666ae43061feb1366302b'
dependency_hashes['Jinja2-3.0.2-py3-none-any.whl']='f4b0ab78d9c2c14afac6ae379a235d3dcb68e5c31cee2bb4a7b39ca83221b400e3e2171ad2b410e321313d7a70814dd8b0de130bc7ddb981d99f24fa051b4f21'
dependency_hashes['Jinja2-3.0.2.tar.gz']='cea7d24656bbc9117785886caee4eb28bc417bd7529152493ac2dd5041d798a1e30c0c5c619327817a708b1af8d08f13ae9125bbc7cb7d440045cb54d7bfbd9e'
dependency_hashes['MarkupSafe-2.0.1-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='510213374b9edcafe128455f7f28aa5f769569b2f217a0ac681fd18cc27c0bcf797a7c7849d48b0e4f64d6a0797e4af1464f90964886745806812186e17d684a'
dependency_hashes['MarkupSafe-2.0.1-cp310-cp310-manylinux_2_5_i686.manylinux1_i686.manylinux_2_12_i686.manylinux2010_i686.whl']='f710a0fe7ddefac402c7416e05b3b01e19f9dd5836bda967c5da09db8d88cf55c039f6a42795c4bcf1f924197fef6f163ff3e0bd1210d6912125c9ae8dcf2ac4'
dependency_hashes['MarkupSafe-2.0.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl']='8fa8de52f7b62c5411f8274884a6b159a104cb5265c9a6ba60e8e2ba87ae9221b91e25b35edd3ad24d078970969469e72afe66e7a6701e8a7cb208f0cfe01ee6'
dependency_hashes['MarkupSafe-2.0.1-cp310-cp310-musllinux_1_1_aarch64.whl']='f26cc70723f5ce47210c2149d1ebd45a41d125252f5b01978e4229ed8349e7f6a59c89f4b6ab6adc6ef9de3cb6c3d70ba0afdd6b573fced56eae738b43581763'
dependency_hashes['MarkupSafe-2.0.1-cp310-cp310-musllinux_1_1_i686.whl']='e0dee3335b397bc93091c54f45f69ad1a9fd23098edb0428a629484acbbd2176b2bec9344b899be6b14a24602be2fedc0fc22f067fe837329b9c669a36367bf2'
dependency_hashes['MarkupSafe-2.0.1-cp310-cp310-musllinux_1_1_x86_64.whl']='78f83c54591e0f739ced53b5207de573f388431e35a57a2e2b25688bf8804ae837a388e10d20e5fa301a7fa656f04cbccc6cc5def4a5b61ed842751d0f4caa29'
dependency_hashes['MarkupSafe-2.0.1-cp36-cp36m-manylinux1_i686.whl']='1d046eae0c7a18fc9a09ff2ca52e8d05834eed7135dace51cc17286d4a98aebe32e806e9c581d445ce43eb7299856bdc3ca4870565ff2ba40dfbdae087904fd0'
dependency_hashes['MarkupSafe-2.0.1-cp36-cp36m-manylinux1_x86_64.whl']='796b4d69860be9dc49a3642b477a1ba161a2ed21144a42d981aef0f8c9926d773cb7380af3b54088b84ec5b0007fda484a32c05b928788fc81b63039f95a8f2e'
dependency_hashes['MarkupSafe-2.0.1-cp36-cp36m-manylinux2010_i686.whl']='f28effef1954e22ad163b70ca6dde1d53010aacac4b33244372027383ded575fd68a193ebe0be76044f6dad4fea380b743dfd72bd87de1e8d84af2aa4291048e'
dependency_hashes['MarkupSafe-2.0.1-cp36-cp36m-manylinux2010_x86_64.whl']='7d72c81a908daae9f9c1a9ae220b6a24af7b8fb4cc7765f209c74616328236a7fc08e598aa1a68af6e8c563262f38eb6d869fcb445c4e39c4fb21bbfe49d140d'
dependency_hashes['MarkupSafe-2.0.1-cp36-cp36m-manylinux2014_aarch64.whl']='e393dc7df3f8c8afba005d8706d97bce2981ab43c83743b6f7d3c73e53f2844c9e1b67c929355cc06b938b8fb989efa92e3ace4e491a8c30857bc735893d7b4c'
dependency_hashes['MarkupSafe-2.0.1-cp36-cp36m-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='a41af69ee901bc078813f3076ed3e8703bba516d0ef2a209a2c1c580bc51e3e9744bbc742891ee20c07f41994d0d7d244653fbe00ac10bec029078025462bcef'
dependency_hashes['MarkupSafe-2.0.1-cp36-cp36m-manylinux_2_5_i686.manylinux1_i686.manylinux_2_12_i686.manylinux2010_i686.whl']='f079f1e8bc214776273ec543b09cfc4eafa1b0610a902bc24e269488bc993fe7a91be15fb733e3dc7d2395646dc64b4ef3339b0b9089107351f17907f73cc0f0'
dependency_hashes['MarkupSafe-2.0.1-cp36-cp36m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl']='31e8195d5f79d91c85fbfed96bd7af5a867a9ce56b284103666c23e7514a3613ac0ed769ecbea6a4cceb0a8ac8fffc3a66704fdb952dba74aeaf1ab194b04736'
dependency_hashes['MarkupSafe-2.0.1-cp36-cp36m-musllinux_1_1_aarch64.whl']='db8482f1a93d68146323c36196b720763e8d2ec48f86e3f6b17992540ddd57cda343bd1f134e43c6ceac033500b719a1dda270eee30e13af19e135ed54ee675e'
dependency_hashes['MarkupSafe-2.0.1-cp36-cp36m-musllinux_1_1_i686.whl']='e67474e4e1eac4266490e8a2312982a6868e586125e7fad45f624afd9401e0bb268e64233797f27d01138d549a1e281015773155782a8bf3d18ea0310aacb803'
dependency_hashes['MarkupSafe-2.0.1-cp36-cp36m-musllinux_1_1_x86_64.whl']='efbbec5215f6dfd5a1462462a72e982878e91afc1b9dc785324efbb1b584a741c1d1109467a1feb363325ae47d9a99cf0c78fe0ef4430fc89deefd0520b3d3f7'
dependency_hashes['MarkupSafe-2.0.1-cp37-cp37m-manylinux1_i686.whl']='41e98e2179f19955b0149a447154a1e9eec6358baa28476823547e0b4cecbc2621a266d93af009263511b86f56830c68ab063c20b6bf6edb7291fc938ea5b23f'
dependency_hashes['MarkupSafe-2.0.1-cp37-cp37m-manylinux1_x86_64.whl']='996409dc75f8b74fd6d061d597a00799c3157f4aa33d15e51dc7d7c5c527000d7dde79eace1924b5974c113ac90827ab354a2e58ec4707c62ed6a2136cc0c940'
dependency_hashes['MarkupSafe-2.0.1-cp37-cp37m-manylinux2010_i686.whl']='ad1ae4d16d8a8887b018e0f991ed0cc7414cafc92fd2d0dc8549dfd7e528e8be3d4085ce3419b06ccb06e96a4aebc1466522236dba480ac8d639b4bc7c8d6b25'
dependency_hashes['MarkupSafe-2.0.1-cp37-cp37m-manylinux2010_x86_64.whl']='8c02a6f72f55c8789c17b5795061b72b2964bfdc47a4956fcce9c5d7bef060ba682b9fce494256d135274407a37ab31e0048fe71ade5c0c4efefbfab18061b5c'
dependency_hashes['MarkupSafe-2.0.1-cp37-cp37m-manylinux2014_aarch64.whl']='b367223335bd0017bad2ffe6fab84214867d0b5b8aec7c849872bcf51f586c3fc3066d1f2155dc8ce75c6f8d7361a3daf6de086365ef54f609daa9f5cf50bc1f'
dependency_hashes['MarkupSafe-2.0.1-cp37-cp37m-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='eeda7f106bb2b71c430c5aa56c62ca4246f9bd502dfdb5cb019cb35920bf9e2a966dd9622fc7abb2f8aa8460f81cb72eeda170efd4693ab2c2c3864c326d2cbc'
dependency_hashes['MarkupSafe-2.0.1-cp37-cp37m-manylinux_2_5_i686.manylinux1_i686.manylinux_2_12_i686.manylinux2010_i686.whl']='636922ba3b8e01b651124aae2a174a0633e502e0e7d004670083be345a6d3a4ff5a31e050fa4182ead69758f29b76f246f9a727fcdb54dae83bb64bf04b55288'
dependency_hashes['MarkupSafe-2.0.1-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl']='16545c5601952cc0d65f10818037ead138a6b3359ecc3dad18f6c73d0b7c59a4d59f9366fbbfbcd56e69710412dd7437c4c5a4b54cbb32e7420139cdc23e2933'
dependency_hashes['MarkupSafe-2.0.1-cp37-cp37m-musllinux_1_1_aarch64.whl']='27f380054c39dc345b1ea09014df299ae73f4aedd4edd3d91680a85bfdbec5d52fb9a82746e1f326c394cc046266b3fd27f1c5e4ff4a1d5eecd9b9a019cdfbb0'
dependency_hashes['MarkupSafe-2.0.1-cp37-cp37m-musllinux_1_1_i686.whl']='0df7f00009ea475982f7b71096c77d8cb8f52669722af15c89ca4e7aab92477eabf5895406008929c916d09b032a1f8a6bf0a9c71f665cf430959431e2aed3d8'
dependency_hashes['MarkupSafe-2.0.1-cp37-cp37m-musllinux_1_1_x86_64.whl']='fa95cb808f78a2a438739a8bad714ab21e3d8ff98b60b4225583cdca694d61aaa3d6a2d025f6ec503301db9e0cb79ad1b7683af9506d86c9756caf795ee79242'
dependency_hashes['MarkupSafe-2.0.1-cp38-cp38-manylinux1_i686.whl']='b60deb0b4f5a34c70433f723a523434b56ccd76381abf71a2a57da86b8962b01ddc3d5ebeb090419f141a20583a43a23558c587ce97246687745b6c6ae47657d'
dependency_hashes['MarkupSafe-2.0.1-cp38-cp38-manylinux1_x86_64.whl']='f6a2d6e0ce38f8262aeed074c31cdabc46963b5e3970ed1a7af7f7557934fc08f15d53a017265a8c0a76b7be6133ffa257d3d92e6e4c2977cef329de94be5c57'
dependency_hashes['MarkupSafe-2.0.1-cp38-cp38-manylinux2010_i686.whl']='a946e2bd83c3babd5e5d5ff7d7320f023023cc5aac5928855f0fa8bc3bb56199c5b8dce09b06fde008432f753c6a7863779d6feb7c747e9efb8ee1938f3f8819'
dependency_hashes['MarkupSafe-2.0.1-cp38-cp38-manylinux2010_x86_64.whl']='d1a20c3fdc42f73476e2ac25c81d6220e915395651aa4e671539f349bca40135e4c9556a7ea04cae4cc426985035637a951a66a013897913984d44cf2628a789'
dependency_hashes['MarkupSafe-2.0.1-cp38-cp38-manylinux2014_aarch64.whl']='e19b733bedd8ccc3e50ab54fea39d20ebb2af81a6137c0aed55315c1f7c8e13c3976ada5773e159935334f1aa6abcc4d7fff153d90d86de9e81d92bb90434f41'
dependency_hashes['MarkupSafe-2.0.1-cp38-cp38-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='87e13dad4d5f5f6324f974034da59626a04ebb0112e6eb69c779b70ce0bd79506321442d6e44e4653db1b7ccee61fb64426262ab2193cb5e098c592f580e8fce'
dependency_hashes['MarkupSafe-2.0.1-cp38-cp38-manylinux_2_5_i686.manylinux1_i686.manylinux_2_12_i686.manylinux2010_i686.whl']='b04e8a3e4fe0c8ba1948e7d21ce191db998d50938fb1650b18e211fef7e55f5e1b53b1e122470c3cb9866c99e0d82238d495a0cd7206cf1ed0ccfa37bbfeef83'
dependency_hashes['MarkupSafe-2.0.1-cp38-cp38-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl']='c9e4d887b2a17572b895cdf12a618559311336edfc6175cece000d1e3aacf1a4a93c8a878dc945814a9ce534e6637d915e1f9f2d1ea6b78bd5e74f43c3f5fc47'
dependency_hashes['MarkupSafe-2.0.1-cp38-cp38-musllinux_1_1_aarch64.whl']='c360f52d6d0abcad4257e49d4b72e27e654d8df2d61225a049897718860489056eef7b7b994349d796f8f29053fc4427bd27b7668aef3c94755e34a3ad4ec206'
dependency_hashes['MarkupSafe-2.0.1-cp38-cp38-musllinux_1_1_i686.whl']='340af4887e0e797889911aa0b65c234be498cb3207bbf7cd5adf952c5a4987e734565c7ccef9bdb03f24272bafcb122187d32176b49e62fa45fc8a274b040ae9'
dependency_hashes['MarkupSafe-2.0.1-cp38-cp38-musllinux_1_1_x86_64.whl']='e4c2ac296a2fa0273a48b7bf77ba39a1de63138ff470455e2099d1c052a65d470a9f78392661b2adfab5651c907f02664cef644c11de7a55714ab35006940310'
dependency_hashes['MarkupSafe-2.0.1-cp39-cp39-manylinux1_i686.whl']='10dbd4ab97a6ad405a938f0736f3ba5ec33c66b59b8420800e1df46c656e420566ba27e9917dfd11220e62028afad355fb21667f46a2c1cc765c987442a4b208'
dependency_hashes['MarkupSafe-2.0.1-cp39-cp39-manylinux1_x86_64.whl']='7121a844bbd6738e28de4aca24cc2f49a810d468da519c5cf64e940afc80b6b01229125d6856b0b099a7f84f39da1327cab7a1cec5b1ab8a3aeaa4dcfe973646'
dependency_hashes['MarkupSafe-2.0.1-cp39-cp39-manylinux2010_i686.whl']='46accdded7f03c49a6bb12d5e3765446ab59d5bf42fdd831e4cf04d591c434ae6642efe1208b06fb22192c979a5b5cbf8a242fb120d1402f048b6fe1f3e0627e'
dependency_hashes['MarkupSafe-2.0.1-cp39-cp39-manylinux2010_x86_64.whl']='450469a14bb03cda262b70eaf6533cee5890695e30424e87866d829d4e97312a5766480fff7f55dae16733e56daa45cbeaf033e326a1580d18823108cba437d8'
dependency_hashes['MarkupSafe-2.0.1-cp39-cp39-manylinux2014_aarch64.whl']='e01a67f1d1dd3d55d5a377d062c9e95ba80030ce279777a074cbfe363258ad246ed1ecdea981a3d16420468d994e6ae9aae42276ff18558a14e146d28de5ae8c'
dependency_hashes['MarkupSafe-2.0.1-cp39-cp39-manylinux_2_17_aarch64.manylinux2014_aarch64.whl']='d969b7155ece54337f502d4de7360d052c83e01f48c3cad2dbd62df30ebe48926f47532d6b40e8aba8edff3d6d71afebb5edc4011b4c965af2bcb0a74a581867'
dependency_hashes['MarkupSafe-2.0.1-cp39-cp39-manylinux_2_5_i686.manylinux1_i686.manylinux_2_12_i686.manylinux2010_i686.whl']='a695a96879ade19917f78eadc54956506e73be95e959f01c0ae9942370b132c094ef1f0b4e77d4711d59d7b86ea7bd89cee0bcb278631d2a7a4b644385fe535d'
dependency_hashes['MarkupSafe-2.0.1-cp39-cp39-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl']='48f99014efefadd8d00b4458c00c31c82e63e30447fd108d25fd97cb689a6f42595415a26cb9076693529e8e895efe62507fd8740884d1915325338c1a3a7fe1'
dependency_hashes['MarkupSafe-2.0.1-cp39-cp39-musllinux_1_1_aarch64.whl']='25618fda8102395a95b6a592c97543e4e1146e98e077f88334878ed973ef8537bc81701728dcfaf03814ab18086840699e31cd9740369b9afdb4bfa981ff3d65'
dependency_hashes['MarkupSafe-2.0.1-cp39-cp39-musllinux_1_1_i686.whl']='1f176215f39b8e97fe6f1e533e6f02b9034eb3330747e4c97b7bc7e50a537a62bedf429799ebf8f4015a43a484e37fde91c1ebc6ecc30ba2dd77ebb2daa3c84d'
dependency_hashes['MarkupSafe-2.0.1-cp39-cp39-musllinux_1_1_x86_64.whl']='1abd70197549d0417f5b66fb861e0607bbd57dd155b6f0e6f47a1d661ca516e3971d960635a3c7c046a6f750b3a3ed2b9ad1da562b5e12c6f634dd6945650ea3'
dependency_hashes['MarkupSafe-2.0.1.tar.gz']='77249bda784111ece15d59eb3de1cbb37a58fb9f22902fe6b73fea9eb0f23857ccbe53dc55463278e3b91f78dc35e2b027fd823ca50d88d8985d5a98ce2327f1'
dependency_hashes['pip-21.3.1-py3-none-any.whl']='75f0af064e3dd4cb747d1f95dee41fa01758991f791f3111ce867f432407ceac33e9c20a163b7930927d2c4ed4da763b72f1afbe6cf734d2de8171dbafb0af50'
dependency_hashes['pip-21.3.1.tar.gz']='cc8cb13a7f4f53ddcaa1bf10586d0caa51bc334728bbd664f7085b3bfbfd09d082c2f01f4d1ecd6a69d7228976058a965087f1852da6d1155526fac1f107bf13'
dependency_hashes['platformdirs-2.4.0-py3-none-any.whl']='346835df30c4314e3434493067e5c5c0e795eec6311220bf4b89311ac4d40e81d25ebffd8b1fe4b9cf116965c8c8011892b03926cbea324209e5971d1243d83e'
dependency_hashes['platformdirs-2.4.0.tar.gz']='476f69a1bf91468f2d0285178adabf2f9fccc9abdb084008a7cce46535b1cc2e903511f8d02e03494ad9d26ccba81a0cce8e87e491ce3264582b01f6c93a2c7b'
dependency_hashes['pycparser-2.21-py2.py3-none-any.whl']='aae67923f45abd1d781d03e0ce848627a07e9cf4c61a89bf32f1b5f638ceda08de39a038c46ed29d2df967d76be4f2572346bad087ac32b418e6fe654fd28e43'
dependency_hashes['pycparser-2.21.tar.gz']='e61fbdde484d1cf74d4b27bdde40cf2da4b7028ca8ecd37c83d77473dab707d457321aecaf97da3b114c1d58a4eb200290b76f9c958044b57e5fed949895b5f0'
dependency_hashes['PyNaCl-1.4.0-cp35-abi3-manylinux1_x86_64.whl']='bf1bb46d23419cb375bcf620a37b5e9ce925cb0dd55eadf851a4bbb9039c8846ed13ae33966436a96655ea41ad1fc282f9139a958fd55ea10597fd3859635a2f'
dependency_hashes['PyNaCl-1.4.0.tar.gz']='355b974010f94d551f631a2dd5ae792da3d4d0abf8ed70b6decc78aad24a9f965636988aebd14947b137ea14cdcbb73531775f08b1b4d5a9d72b5df3dba0b022'
dependency_hashes['pyserial-3.5-py2.py3-none-any.whl']='29bce14c59e60f54ce476d919c9b9477190ef6bb44a6102f71345840f5c0f1d0a323c4c3c302c5f380bfaae32cf04142ee528b6dd7184f17789632a31d5ecab6'
dependency_hashes['pyserial-3.5.tar.gz']='c8df5e50d952d5a6dcf1d9253a6ba953e9763c545a867da66c22c90dfa015aba0194f2a8f29a229d0a5f4dc8bfeeaaab8bcfda4066ed78a18b151bc05e6ae327'
dependency_hashes['PySocks-1.7.1-py27-none-any.whl']='3e0b1775c14fe091d10e30b03f7f0c770861152e493cf3a3143b0de01aadbc73f684f0d4305f1a694932d4bdcac8056c422437130640e19028cd9fba59ff0b3f'
dependency_hashes['PySocks-1.7.1-py3-none-any.whl']='313b954102231d038d52ab58f41e3642579be29f827135b8dd92c06acb362effcb0a7fd5f35de9273372b92d9fe29f38381ae44f8b41aa90d2564d6dd07ecd12'
dependency_hashes['PySocks-1.7.1.tar.gz']='cef4a5ce8c67fb485644696a23bf68a721db47f3211212de2d4431eaf9ebd26077dd5a06f6dfa7fde2dcb9d7c1ed551facd014e999929cb4d7b504972c464016'
dependency_hashes['requests-2.26.0-py2.py3-none-any.whl']='ab0b245535ed57b6b05699a5e032d6114be081e682ffd4cd0414f861d1b216db5bce640c3996bfce9cbdbca6490c999d5925cfe713c6026adb0d4b035084dc76'
dependency_hashes['requests-2.26.0.tar.gz']='c3397d77f0d2f1afb05661c4b98adad6c1ddaf360906254150b33ab0d9479fd306905bd6d61b8cf8becd9a40bdcf9b03542e8267c644ef19f03f44bfca0bc461'
dependency_hashes['setuptools-58.5.3-py3-none-any.whl']='7528315ca9ace4539e38d01fa6d97400ff32fab41faa33706a63767bafa0d2d63f2a53366fa962721855eb82d15f554a51422db079a07af9638fb94166839394'
dependency_hashes['setuptools-58.5.3.tar.gz']='84250620310ed02eec5d01577e26c30a3ab580eab7de48a954d1dc36d84b7855f8f59f0021bdbf2f20ffecabe613ca173a0394fff53c8ab692d89db8640770c8'
dependency_hashes['six-1.16.0-py2.py3-none-any.whl']='656b010ed36d7486c07891c0247c7258faf0d1a68c5fb0a35db9c5b670eb712d5e470b023ffd568d7617e0ae77340820397014790d14fda4d13593fa2bd1c76f'
dependency_hashes['six-1.16.0.tar.gz']='076fe31c8f03b0b52ff44346759c7dc8317da0972403b84dfe5898179f55acdba6c78827e0f8a53ff20afe8b76432c6fe0d655a75c24259d9acbaa4d9e8015c0'
dependency_hashes['stem-1.8.0.tar.gz']='aa2033567b79aef960f8321e4c6cbc28105c59d6513ff49a9f12509d8f97b1a2e8a3b04dc28abb07fad59b0f6ba66443b92bbefa0d08b26038bbaf24f7f2846d'
dependency_hashes['typing_extensions-3.10.0.2-py2-none-any.whl']='71bcad371e66df0cc3dbf2e59d26cbdab47da5bee76779dbfe25201bbb910b91595a9f8d08e6b6761fffd523b9f59d83ab2c3d6f9000968e1ae5bcb9f4a821c3'
dependency_hashes['typing_extensions-3.10.0.2-py3-none-any.whl']='3f530426108369c946b6df76d7120cbbfba65d167059a21e9f88862433ce61cb84390f186c4110afe28ebe0f0cdcb9d95a95d3c008246ac0f578e03fb1496e0d'
dependency_hashes['typing_extensions-3.10.0.2.tar.gz']='171ada56758fb04328a2cafefe80b70fbf166f2d799406883df642927964925ca73f04d0646661cd4fd016dfb5e1856b84f362e3b404c27b368ca06a09cf87db'
dependency_hashes['urllib3-1.26.7-py2.py3-none-any.whl']='a81538eb339c2d030581b401e2c43a7d793e4789018c814a335417cade8b320620d655d956c93675ce6bca441b51c69ec60895c29dee2ecd5f1278489928420e'
dependency_hashes['urllib3-1.26.7.tar.gz']='6f5a5e6dd5ff99950fcc051495e0a698153b57e20b6c83d869b54c7fece9616909bcf2fe99efc40815f8722996ad93e430bf765ce5c629b912690c286014b86f'
dependency_hashes['virtualenv-20.10.0-py2.py3-none-any.whl']='70e97f27d3bc48f5f4de78257dc6dd36c98b80b3a65e40a84946a3ba882585ac69ec5f7982617f37da66a4cb2f288b52a2daa54a465f747e8300f0fb08b396d9'
dependency_hashes['virtualenv-20.10.0.tar.gz']='df940aa29801a39d39be46d3518a99e93efb2113650abf81d00b4545183ec6806823ce8b754c5a3c951cb64e941944421046c709ed3de6a925489e5ac1988d48'
dependency_hashes['Werkzeug-2.0.2-py3-none-any.whl']='55ec2b58aa2099982ddf53be7764f4f610fe47909742525658a71e3b59e392a48415f7d871ea7777d5e0f2b74664e9105ae876540a0caf9b0c56fdf9c897d0d0'
dependency_hashes['Werkzeug-2.0.2.tar.gz']='184cebad079195ee7bd5690bef26c6f9064046e81e610056960554f27837e3eb904a9d7381b575a373022c4d408fddc12981a48a55c301118691c1c88326629a'
dependency_hashes['zipp-3.6.0-py3-none-any.whl']='c57fd39f44fb6a3a38556a20e58d54c7820774c509b2f730488f607ee4be014a544c11e948c0226c75c7447b69c9b3e2d9708481cb5bdc5464486c0eed1e0bf4'
dependency_hashes['zipp-3.6.0.tar.gz']='8e21b0a757ed9ebddeca43d3e4b64549dc4e59f781704626b0b2b0a117752b84798a0484cceedd4684ee0459643df4d0f479e64a143c8d9337d2b66951a7b227'


# ----------------------------------------------------------------------------------------
# Package lists (the list must be ordered so that sub-dependencies are listed
# before packages that use them, and the list items must use the same capitalization
# as the dependency filename).

pre_packages=("pip" "setuptools")
virtualenv_packages=("zipp" "backports.entry_points_selectable" "filelock" "importlib_metadata" "six" "distlib" "appdirs" "platformdirs" "typing_extensions" "virtualenv")
tcb_packages=("pycparser" "cffi" "setuptools" "argon2" "PyNaCl" "cryptography" "pyserial")
requests_packages=("urllib3" "idna" "charset_normalizer" "certifi" "requests")
flask_packages=("Werkzeug" "MarkupSafe" "Jinja2" "itsdangerous" "click" "Flask")
tails_packages=("pyserial" "PySocks" "pycparser" "cffi" "cryptography" "PyNaCl" "argon2")
tails_packages+=("${requests_packages[@]}" "${flask_packages[@]}")

# ----------------------------------------------------------------------------------------
# TFC Source file verification

function compare_digest {
    # Compare the SHA512 digest of TFC file against the digest pinned in this installer.
    purp_digest=$(sha512sum "${INSTALL_DIR}/${2}${3}" | awk '{print $1}')
    if echo "${purp_digest}" | cmp -s <(echo "$1"); then
        echo "OK - Pinned SHA512 hash matched file ${INSTALL_DIR}/${2}${3}"
    else
        echo "Error: ${INSTALL_DIR}/${2}${3} had an invalid SHA512 hash:"
        echo "${purp_digest}"
        echo "Expected following hash:"
        echo "${1}"
        exit 1
    fi
}


function verify_tcb_requirements_files {
    # To minimize the time TCB installer configuration stays online,
    # only the requirements files are authenticated between downloads.
    compare_digest 6f0d599c7745837f87a03383220b54222f9ee0bd29f69d9cee969bff5cd6cf43b6eafc399550a7c6bb152377418a3a950fe8ae43a22962d547273b2a82952db4 '' requirements.txt
    compare_digest 5452555f254ad5e44d6ec4cc17adbe4d7a71f7a62b82599f8e505bfe1e36fa27a6f3f911e1450886a6cdd888b2b544bdef6d8156871e6b111f60aed232b4c4d7 '' requirements-venv.txt
}


function verify_files {
    # Verify the authenticity of the rest of the TFC files.
    compare_digest 91903d08a440192030dee10d1099a5c612280b5f8c63847a48faf2ddf99dd198271b132a24ce3921a91113946598f17ac0af15d4a41982e4dde5d5857b05b61c '' dd.py
    compare_digest d361e5e8201481c6346ee6a886592c51265112be550d5224f1a7a6e116255c2f1ab8788df579d9b8372ed7bfd19bac4b6e70e00b472642966ab5b319b99a2686 '' LICENSE
    compare_digest c96801213615c13752ec3a5f3436bb749cd3efbf25443a5a634e708fbd5fdec67df646f8db150b3dc2d0aefdf9bf0614e383a54ce0e0aa82f2b554842680ca58 '' LICENSE-3RD-PARTY
    compare_digest 9d8b08c7631d7f7a3bff531b1f5870cda85ed3067627a1a426cc90dd5a87e65429a526194c7e323dd949000818d0e31a5a7664075733700ae1218f9e881bd12f '' relay.py
    compare_digest c9fbbe74ae06348ee011e407190f7e9c4141a3b750d24caf7293bde9e8a93a79f468f1ab7de43d48d90dd47b5d44dcb14a603bb7035a2963447937023fecfe02 '' requirements-dev.txt
    compare_digest fc219c0b0f7ff8e658fb359c611375d16c72de24086eb276c488e7960a82744c41da8b91d73d6ee76ebf078178259b93d21c8602fadeeba92149e695069e88bf '' requirements-relay.txt
    compare_digest 502ef1e8cea317db5351ff4d056ebfa12778caad1d8513b19236ad15da430415e7db6306edb2f37acf7e00105bcac97b51bcd68a3e661d6c116f88dc607db112 '' requirements-relay-tails.txt
    compare_digest 0f64e4cf749e6d5745824de9e5736642792700a2316e0f7b0c58a38e578d5ef7ccbe2186c2651173b08ded55b86b0d319afff8f3a43e450c0269dcf6a9310dd4 '' requirements-pre.txt
    compare_digest 79f8272a2ab122a48c60630c965cd9d000dcafabf5ee9d69b1c33c58ec321feb17e4654dbbbf783cc8868ccdfe2777d60c6c3fc9ef16f8264d9fcf43724e83c2 '' tfc.png
    compare_digest 6ec4e2f4422bec2c4dfcb4ec630bfbb332f7a1f6b9d500a26bb7641dd9882f1f7297a0ef2b3f0603d669ec69eed001a5cf1cb1b2e74d5e53a0cefa0fc8ee8c95 '' tfc.py
    compare_digest 62f26d2805570ee70fad3a076579a554008e7d9f2c9ff310f3bb5876d361cc03dbae7ab63b144ac215a35f920ac56d359481352805a356479d622ab00da15f7f '' tfc.yml
    compare_digest 524e2809046cf0d91caa970a6aa7399c86dbf746ab2b5ab1d3002730ee78f02a6e748221511e4fc98f795f19ff8249070ffe11a2eb521dc1f82ede4fad4e4264 '' uninstall.sh

    compare_digest dd2dc76c186e718cd6eb501985f3f8c639d303e44186c5f21ca8e8cf6a25b329c573ca489eda80877be51ccaa6b72b4e763060d0f0f27c0217e8c6b1016d75ca launchers/ terminator-config-local-test
    compare_digest 55e908212a2c9d5d8d14adaefbead5c5c49245d45bc3278ffbbacdcaad78ad5e786e086cf73e675447af83bc86648c16a41a996f1f794b75ef55a664a9273e47 launchers/ TFC-Local-test.desktop
    compare_digest 0a4ca9d76912d27cdea4f36b7334ab561eca2b056eef24ff3b1484cb5dd56c5d79e68145402dbf40c87d4a86340cadeeeadf63a8c3774b89921906a1df603c25 launchers/ tfc-qubes-receiver
    compare_digest a8257a49bc5b9c76ab7a228b69d518e7f7ef338cbf4ebe3df64e99d96d7939130b9005b35c962542e5427ae00c1f2623c06a357614a3122d0a3b161e5d59bb0b launchers/ tfc-qubes-relay
    compare_digest b8a7b0614924e000495c1a4f380c5fd772e85ed93b58b8762c1b1f54381730ef3ec1fd7c7bc0541ef6ce9d857402f2153c8abb9c4b05ee2e57630fcf53ef3c35 launchers/ tfc-qubes-transmitter
    compare_digest 0bd254504958f1231f7964229311ccba0dbec46273e4304473f4f597f4ba5f3973caaacbd4bbbe19abc6352b2922ffba15af1eb87eda775b28c2d022bc80cc88 launchers/ TFC-RP.desktop
    compare_digest ec42932ced96857c54946fafb81926c0392f420c33daefa6a11d917976b84e393d9d8c0c97f6e1efb5f067d5eaa24f332ca848ffc17a326c5f6afbfb6121991c launchers/ TFC-RP-Qubes.desktop
    compare_digest 0bd254504958f1231f7964229311ccba0dbec46273e4304473f4f597f4ba5f3973caaacbd4bbbe19abc6352b2922ffba15af1eb87eda775b28c2d022bc80cc88 launchers/ TFC-RP-Tails.desktop
    compare_digest b10cb9ede783e7dab89d247490699fb9d6dd8aa96483a691cf6c837c1b45e3a5dcf2bc127077baff4dc58133746d4423a4dc922f8b7f089aa3711f4404306027 launchers/ TFC-RxP.desktop
    compare_digest 13da29225e84fd258a36514885d04445d530103a942727970fe9ae8a61b7fb6882556abd4df77c52f9d3ff62d800fcf7c7c79bc51e2b04492a67fb96e970d1f6 launchers/ TFC-RxP-Qubes.desktop
    compare_digest 2c0869a300b4088d9fb7d4cb95552eeed978de7108a756a2275ba7c399c044df94ed6355398b2a1c71b51b3d9f682b5abde536d8a2e318a06e8e632724b343f0 launchers/ TFC-TxP.desktop
    compare_digest 81fddbdba5abb1693fae027c7398681754182f1324e2d57e6cc9d66ab0c6800bfbf2aa07b15bd8525aac5992c5e48a79b20022133caa9991f08a05f0651d107e launchers/ TFC-TxP-Qubes.desktop

    compare_digest aea3558d9f2855e79b715e92147411d9ddc9ea43617ad2418497466d82fc749f2cb7b1278c87bfd4a93e334cdaac24c66b2a8d95c33adc5e3c4081365d0c2d23 qubes/ service.sh
    compare_digest 8929de27a32f001f5bb73070868b5e5c8bc9ad74afad63b27ce4ffe946dc0b81e83a178ea7ed752d79be53f9ce84343175b18f0254482dac377c8143ad56a3c4 qubes/ writer.py

    compare_digest 895b722c3cea8f5aa1d4bbcf228cfefc93882098ea35473d205d839cca70bd234f6786dd2ac8004ef854ec7b5e3a3aeaa7c55ccf3797ccb8dcbe530a4f64642c src/ __init__.py
    compare_digest 895b722c3cea8f5aa1d4bbcf228cfefc93882098ea35473d205d839cca70bd234f6786dd2ac8004ef854ec7b5e3a3aeaa7c55ccf3797ccb8dcbe530a4f64642c src/common/ __init__.py
    compare_digest 259f9b5cf3a1ebc6288a5120d8d98f1bc81cb2cf2d0dd03d9ea5ac831f1bf2c004cd89109c0c3c60d25c487d83b3ba6e6d3ef6747e7b33a4bf4a59daaea9e8fe src/common/ crypto.py
    compare_digest 8dbd4aa15f46f57b9e10278333eddd626de55e742176570edf1b5aa4e2ebbd9cb850723441d2961f163aeb59062464caf3952d9f19151021a22e1bbaf3c794c9 src/common/ database.py
    compare_digest 51b556a5ccd6bc1c2b677dce9170fea4244e5d6fe578fe4ade315764806ad95f28a32fdd9f7f549e89e4667feb934f93923ac10b0eb6db96ecfe8717314fdc6c src/common/ db_contacts.py
    compare_digest 52bb5eaa36727a2c977cb20811501af9b4d044546ba8de3844b0077d5a18ce6b1a5e828b79b6e5044603532c0d2fbe205dcea6cbb2e7a2985359774798b4dd77 src/common/ db_groups.py
    compare_digest f2da629d149582a01e5bea92d66cbe3120fa32bbe3bed3af12a5ce88b44876b12ecedddd799baa09c93c459d9d9befd38b35418f11c709d094fe685ec679a437 src/common/ db_keys.py
    compare_digest 02a5320292048a7b5a8e2c65753f38607ef4446d0ca60bf0e9fcb188da4bac2769eccc378fff824b4be75e325f79ca8da115260d9d3535d45e4fee5e2e8b6d34 src/common/ db_logs.py
    compare_digest 026ebe896f27c539f9d11b7f97a690fec9d5f6288048ae924a8c27be0569ea3d25c62ce0d8fc8b14c1c209e196a7aba18ee5ec0ba60842c627157bdafc136bdf src/common/ db_masterkey.py
    compare_digest e51732cb3197d6d6fa9a3a6d6d1edd9f2f217487aab913deab7d9b3990c87093723d462d9e180e6c5917e26cf3d2dac34b5f6d305a8193eea111abefeebc90f4 src/common/ db_onion.py
    compare_digest f77a4f2860b0778a24b9d7d3b27ad4eb5413a128d8c2abfff7a6c3e551fd07b4013bc4dc5221a57fa45b16aba25a16b27cc24033b1f270148905efa0a17828c1 src/common/ db_settings.py
    compare_digest bc8d7c9a4ed4ce80e5c4951ec5f59cd108f407cd511c2984f535c4e43d71c61030f00053f2ba230c16726cd84fbd6f761395527a947b5c0daafe26cb9aa509e9 src/common/ encoding.py
    compare_digest 270ce6ff837376ec3d6653faeaedd40ff69f083dbad32ca625fcb00f940e5338de9dab5710c8171d43e29ba73bddae5e670d11e7817404daab0eb3a565ea2316 src/common/ exceptions.py
    compare_digest d2f6184054344da185d4e52a6957de6e53bca1250ef02839c41e8a8cc0ebdb05567fc2fc0d7c52ea3e91098b1660664ee28cc4b945492797ee684387f857d1b1 src/common/ gateway.py
    compare_digest 9881dde36489c590746257e064f8800b56ef3fa4a78738c15f421998c8ac8469e1191da7ae4a37d5beb54f59bf2ae5d0c20fdae40a4ba66e4c21e9d0675ca6af src/common/ input.py
    compare_digest 3e09c6bb28bee40d7ddf67eb4d24ea38ef3ac5c649f92a95a165e9532f3570bf747a8c7cffe09ad55a4cc1b7f9dc6b60204cc5a212afa9fa3f510c65d85a3086 src/common/ misc.py
    compare_digest f23e5b4618a63ea2161707b53131c5ad894fd53d2d3481cc874e02d63eca7043d6010edd601298d38a16e86104acc59fc80d0fe89a9693084709365b188b3c7b src/common/ output.py
    compare_digest 83dce0462374789f04d16d47e05cfb9aa5a9ce1e0bb0e280706d0c6f291a2bf680ffe83481b22b28f89d39345f07065c847135620726b29da7c22b349a3aa06b src/common/ path.py
    compare_digest 27537bc76325d7f7261df015535ba4bb4ede2c779d9d15e8f1e4e74c49a68d8530fd8c9b13462b2af0ae1d017dfc57dda8d8f279cea0729c7eecd4b3afd12434 src/common/ reed_solomon.py
    compare_digest 1437e70c6cb52056e67a219c918bfeb180b29c81c204ffb3f2f0d06cc211f929a7698881b47a69a273e3dc04eb4600600a9c126ee910185a5535de8370a56854 src/common/ statics.py
    compare_digest 6b80a369e1bd3bb72b58b309f4559d47201d16ae1cc02f2da0184c4bfb7d086a28d3575e031b78dd7d4d720b1ee2a948412daa83d95ca540e57d07ba59aadd6a src/common/ word_list.py

    compare_digest 895b722c3cea8f5aa1d4bbcf228cfefc93882098ea35473d205d839cca70bd234f6786dd2ac8004ef854ec7b5e3a3aeaa7c55ccf3797ccb8dcbe530a4f64642c src/receiver/ __init__.py
    compare_digest 407273ef8bdaf4bcd482fef5da30f815ae231ca93af67b4f1c07cbc01fa24a046b8f80f9ed1ed900ef60873ba26807e90514292d2b15da035e80c21fcd1285ca src/receiver/ commands.py
    compare_digest 5c9319da7704209deb4e8c770e1c1760a5ca2ff24b5cba99ec87d8398e3f2ea64afb303297b03d229f9ce4bac7a4e81d75e0036c11a8611de5e7e423f1427cd9 src/receiver/ commands_g.py
    compare_digest 6dc42761152d36549f5e9393575fc42d39fed726b03c5f6801f6db7c731bbcfcf22d330bb4bd8b71fc6765f730526e18d5cd0d81dda8792765df614cfa5d5e84 src/receiver/ files.py
    compare_digest dd1584f8d76cc9c31669f2274e98c3f45faff445c1114efcdba0d1c309cd96d2504b835e7a741faa93d35900cf2e90a4543135f3aae3d80eedc9b4f0b1702ce6 src/receiver/ key_exchanges.py
    compare_digest 70f9a8f7a3c9492784933c1feadf975379aa99989c8e1669fc8f9dd41f84beea781fb18a75872c7aca32af89d859f60ed199d0ee89d610c7d21641c46bcbacd2 src/receiver/ messages.py
    compare_digest 40abbb00d4658196d14c49aa36cf9dff0834d73913d28017aa73b58e257990c8d1e3c89de2e446bdd04f4c127d8a9ed1d19ce91b3ade8aa117af3fe8dfe675f7 src/receiver/ output_loop.py
    compare_digest a65905f9d603502052508c8dd5c9a9fd0ed084e2820c0fdebad11aca285434eec77e9809fbfc7239126a052625de5e7269af94c58fb9abb626314a103f77dbd2 src/receiver/ packet.py
    compare_digest 89280eb11322f00570e9b4c0b1f08a333e4af272c11dbcbadfe62e66fba08b507e4139d02254fc59993e80c3388e7ee0ec1d42ec31eadc0c6175f33fbd854c7d src/receiver/ receiver_loop.py
    compare_digest cb00a949b96af8d85a3ae735b3565a22ed8ce32dcbdffc20b5effdaa21c45ee09d12fa80944ec399bb1e2d94d265b570abcf566aa6533179be693957b4b57586 src/receiver/ windows.py

    compare_digest 895b722c3cea8f5aa1d4bbcf228cfefc93882098ea35473d205d839cca70bd234f6786dd2ac8004ef854ec7b5e3a3aeaa7c55ccf3797ccb8dcbe530a4f64642c src/relay/ __init__.py
    compare_digest 91c3d4c61b7ab782716b3fad93fdbfa8a14fadf78f42827e642bea00d41a3ca5fc13d5ce552353ea955fe031e63f79878122302bd0e6d7b85a11917f60fdca27 src/relay/ client.py
    compare_digest a876e5863bad6f1ccca425ae33b539b9a5c88ea3e560efb3c5b16df8f80adf47defe2b0c829f835ea9c57032c648fc7186269b05049d9a129aaf5b787991fad1 src/relay/ commands.py
    compare_digest 40de0fe708a9a925a7475c407f57444cbdd0b5ba7d1045ce7f80c3437f38f278e7ee5fb11e8dc503e3d0d06ee786aad9f77970073f61dc57517dba0af2533216 src/relay/ diffs.py
    compare_digest c211e781f24d8275cd9b338bfd8b2f432d8e7a4a3db0364904c025fd7cedc7ef3bcb1d178a67762af2ecd6d1ef6c3f77c3467748cf9cbf61be98478aa59835c6 src/relay/ onion.py
    compare_digest 127913f8d9fe07cc8675dca1ec29702185fbdce927c1edfabce65a36d5f9ff2b35593c7bbdb3fdd017cd18a79f7606e9c37f8d4b4d6031d7788d35c1f434bd37 src/relay/ server.py
    compare_digest d413dc230cc2e52cbf771a9c141e35c76ca2fa3188876207a0bbe12112459608858f5ad22017dcf7946797d2a39f2f506cb43407c9a3b1e27eb72e09f93906c1 src/relay/ tcb.py

    compare_digest 895b722c3cea8f5aa1d4bbcf228cfefc93882098ea35473d205d839cca70bd234f6786dd2ac8004ef854ec7b5e3a3aeaa7c55ccf3797ccb8dcbe530a4f64642c src/transmitter/ __init__.py
    compare_digest ea7c17e06353b6b2f770b520a11d3b608303da42a0c4c0dc4ba79c9f2df0df4530c2185b532eb188f603505fa37259541bd2e0bf1589917db4e00f158d69d20c src/transmitter/ commands.py
    compare_digest a5467d96d12ea1c9c504719a67630b3f5e0923af2800a0c30e4e0b18811317735e5eb87cd4b1524266ffa69568746c01ed48e2c3ff54be32beb8b2f64b3be1d2 src/transmitter/ commands_g.py
    compare_digest 7f42fcc038fc33336bb16ddd5673c700ea763ffa19cd5aabb7828379e52f35d6187415038cbfed1f1216e08b4b12e644b4241d8753e9bb5a0b24c4a14e06af73 src/transmitter/ contact.py
    compare_digest c961fff77c2386e77ae7c861f2419f65d47a9062969cdf4061821124f2c5e2bfead1eb0f29934804c34612e893947c240ca773213ff585d46553c9bbc81f9271 src/transmitter/ files.py
    compare_digest 585c768965def312b95e97098b770d0e427d6d6c360708318dbd16ba5c032049d96475828824fae1ccb298d6ff1017900d132c54ed3b297f499cea63b9ae2cb4 src/transmitter/ input_loop.py
    compare_digest 01c55aa214678b9a313207d7cdbceea6a078a41e87da20d60914f2321487641f1d367cbacbe73c15fa0fa8ab54ed00239d21b3cd5c21944a4d68d1b9035813c3 src/transmitter/ key_exchanges.py
    compare_digest ae2fc7f56a7c5e1df9fb48d0c805465f9332b57ad1c0493c810b0a9ae4a8f9a7751634e3a0d54c6668394dfc63b4793042fe13f82522781c67b7dc6f11480dd0 src/transmitter/ packet.py
    compare_digest fb5d90be329ad6c5392dfdd85ca4373b8e77ed80f6ddb8c2dd1de721a19fa8734b6543aae0f94c3dd32004c45619cf5b45b08599da10bb0aaf7b19dc0d875ebd src/transmitter/ sender_loop.py
    compare_digest 5df1f280a7e5395fd2800242ca83c3d3415515e3ce0c5e1471b6c959600d22119d9bfc2322897b336252bffcd010c96afa4a947ca95e3bbd602ec7dcc6695997 src/transmitter/ traffic_masking.py
    compare_digest cdc94940b53517ac263b9d6a189176dabf7ddd5239b5fb792ba2229707691a1db2094a104cd1b9525232bacdf12f235bf9683b511adc3088f722a3aec00225b4 src/transmitter/ user_input.py
    compare_digest df6ab1205f39d89879016611a32c6d4ca5add324a20acfa731fb2fbef332221b9b67e9e242725915602ba653c1083a8d749a11eb47187930c2de2cf4227c68dd src/transmitter/ window_mock.py
    compare_digest ea02d0cdd2edcc87e68aed6c15a6c8516c3b838c96d7d83d8de53d7ef3aaf9b48f215b84e6ef4cc88baf6bf4d8c1985ea1e1078bc915ecda7cf5f67fb1044b16 src/transmitter/ windows.py
}


# ----------------------------------------------------------------------------------------
# Printing utilities

function c_echo {
    # Justify printed text to the center of the terminal.
    printf "%*s\n" "$(( ( $(echo "${1}" | wc -c) + 80 ) / 2 ))" "${1}"
}


function exit_with_message {
    # Print error message and exit the installer with flag 1.
    clear
    echo ''
    c_echo "Error: $* Exiting." 1>&2
    echo ''
    exit 1
}


function install_complete {
    # Notify the user that the installation is complete.
    clear
    c_echo ''
    c_echo "$*"
    c_echo ''
    c_echo "Press any key to close the installer."
    read -r -n 1 -s -p ''
    echo ''

    kill -9 $PPID
}


function install_complete_qubes {
    # Notify the user that the installation for Qubes VM is complete.
    clear
    c_echo ''
    c_echo "Installation of TFC on this Qube is now complete."
    c_echo ''
    c_echo "Press any key to close the installer."
    read -r -n 1 -s -p ''
    clear

    kill -9 $PPID
}


# ----------------------------------------------------------------------------------------
# Installation utilities

function t_sudo {
    # Execute command as root on Tails.
    echo "${sudo_pwd}" | sudo -S "${@}"
}


function check_rm_existing_installation {
    # Remove TFC installation directory if TFC is already installed.
    if [[ -d "${INSTALL_DIR}" ]]; then
        if [[ ${sudo_pwd} ]]; then
            t_sudo rm -r ${INSTALL_DIR}  # Tails
        else
            sudo rm -r ${INSTALL_DIR}    # Debian etc.
        fi
    fi
}


function dpkg_check {
    # Check if the software manager is busy, and if, wait until it completes.
    i=0
    tput sc
    while sudo fuser /var/lib/dpkg/lock >/dev/null 2>&1 ; do
        case $((i % 4)) in
            0 ) j="." ;;
            1 ) j="o" ;;
            2 ) j="O" ;;
            3 ) j="o" ;;
        esac
        tput rc
        echo -en "\rWaiting for other software managers to finish..$j"
        sleep 0.5
        ((i=i+1))
    done
    echo ''
}


function steps_before_network_kill {
    # These steps are identical in TCB/Relay/Local test configurations.
    # This makes it harder to distinguish from network traffic when the
    # user is installing TFC for Source or Destination Computer: By the
    # time `kill_network` is run, it's too late to compromise the TCB.
    # Hopefully this forces adversaries to attempt compromise of more
    # endpoints during installation, which increases their chances of
    # getting caught.
    dpkg_check
    check_rm_existing_installation

    sudo torsocks apt update
    sudo torsocks apt install git gnome-terminal libssl-dev python3-pip python3-tk net-tools -y
    sudo torsocks git clone --depth 1 https://github.com/maqp/tfc.git ${INSTALL_DIR}

    verify_tcb_requirements_files
    sudo torsocks python3 -m pip install  -r "${INSTALL_DIR}/requirements-pre.txt"  --require-hashes --no-deps --no-cache-dir
    sudo torsocks python3 -m pip download -r "${INSTALL_DIR}/requirements-venv.txt" --require-hashes --no-deps --no-cache-dir -d ${INSTALL_DIR}/
    sudo torsocks python3 -m pip download -r "${INSTALL_DIR}/requirements.txt"      --require-hashes --no-deps --no-cache-dir -d ${INSTALL_DIR}/
}


function verify_packages() {
    # Verify authenticity of downloaded dependency file.
    dependency_list=("$@")
    for dependency in "${dependency_list[@]}"; do

        dep_file_name=$(ls "${HOME}/" | grep "^${dependency}")

        # Move the dependency to root controlled dir
        if [[ ${sudo_pwd} ]]; then
            t_sudo mv "${HOME}/${dep_file_name}" "${INSTALL_DIR}/${dep_file_name}"  # Tails
            t_sudo chown root                    "${INSTALL_DIR}/${dep_file_name}"
        else
            sudo mv "${HOME}/${dep_file_name}" "${INSTALL_DIR}/${dep_file_name}"    # Debian etc.
            sudo chown root                    "${INSTALL_DIR}/${dep_file_name}"
        fi

        # Calculate the purported hash from the downloaded file
        purp_hash=$(sha512sum "${INSTALL_DIR}/${dep_file_name}" | awk '{print $1}')

        # Load pinned hash from the hashmap based on filename
        pinned_hash=${dependency_hashes[${dep_file_name}]}

        # Compare the purported hash to the pinned hash
        if echo "${purp_hash}" | cmp -s <(echo "$pinned_hash"); then
            echo "OK - Pinned SHA512 hash matched file ${dep_file_name}"
        else
            echo "Error: ${dep_file_name} had an invalid SHA512 hash:"
            echo "${purp_hash}"
            echo "Expected following hash:"
            echo "${pinned_hash}"
            exit 1
        fi

    done
}


function install_packages_as_root() {
    # Install list of verified packages
    dependency_list=("$@")
    for dependency in "${dependency_list[@]}"; do

        # Find file that starts with the dependency name
        dep_file_name=$(ls "${INSTALL_DIR}" | grep "^${dependency}")

        # Install the dependency
        if [[ ${sudo_pwd} ]]; then
            t_sudo python3 -m pip install "${INSTALL_DIR}/${dep_file_name}" --no-deps  # Tails
        else
            sudo python3 -m pip install "${INSTALL_DIR}/${dep_file_name}" --no-deps    # Debian etc.
        fi

    done
}

function install_to_venv() {
    # Install list of verified packages to virtualenv
    dependency_list=("$@")
    for dependency in "${dependency_list[@]}"; do

        # Find file that starts with the dependency name
        dep_file_name=$(ls "${INSTALL_DIR}" | grep "^${dependency}")

        # Install the dependency to virtualenv
        if [[ ${sudo_pwd} ]]; then
            t_sudo "${INSTALL_DIR}/${VENV_NAME}/bin/pip3" install "${INSTALL_DIR}/${dep_file_name}" --no-deps  # Tails
        else
            sudo "${INSTALL_DIR}/${VENV_NAME}/bin/pip3" install "${INSTALL_DIR}/${dep_file_name}" --no-deps    # Debian etc.
        fi

    done
}


function remove_packages() {
    # Remove the dependency installation files.
    dependency_list=("$@")
    for dependency in "${dependency_list[@]}"; do

        # Find file that starts with the dependency name
        dep_file_name=$(ls "${INSTALL_DIR}" | grep "^${dependency}")

        # Delete the file
        if [[ ${sudo_pwd} ]]; then
            t_sudo -E rm -f "${INSTALL_DIR}/${dep_file_name}"  # Tails
        else
            sudo -E rm -f "${INSTALL_DIR}/${dep_file_name}"    # Debian etc.
        fi

    done
}


function remove_common_files {
    # Remove files that become unnecessary after installation.
    $1 rm -r ${INSTALL_DIR}/.git/
    $1 rm -r ${INSTALL_DIR}/launchers/
    $1 rm -r ${INSTALL_DIR}/tests/
    $1 rm    ${INSTALL_DIR}/.coveragerc
    $1 rm    ${INSTALL_DIR}/.travis.yml
    $1 rm    ${INSTALL_DIR}/install.sh
    $1 rm    ${INSTALL_DIR}/install.sh.asc
    $1 rm    ${INSTALL_DIR}/pubkey.asc
    $1 rm    ${INSTALL_DIR}/README.md
    $1 rm    ${INSTALL_DIR}/requirements.txt
    $1 rm    ${INSTALL_DIR}/requirements-dev.txt
    $1 rm    ${INSTALL_DIR}/requirements-relay.txt
    $1 rm    ${INSTALL_DIR}/requirements-relay-tails.txt
    $1 rm    ${INSTALL_DIR}/requirements-pre.txt
    $1 rm    ${INSTALL_DIR}/requirements-venv.txt
    $1 rm -f /opt/install.sh
    $1 rm -f /opt/install.sh.asc
    $1 rm -f /opt/pubkey.asc
}


function install_virtualenv {
    # Some distros want virtualenv installed as sudo and other don't.
    # Install as both users to improve the chances of compatibility.
    sudo torsocks python3 -m pip install -r ${INSTALL_DIR}/requirements-venv.txt --require-hashes --no-deps
    torsocks      python3 -m pip install -r ${INSTALL_DIR}/requirements-venv.txt --require-hashes --no-deps
}


function kill_network {
    # Kill network interfaces to protect the TCB from remote compromise.
    for interface in /sys/class/net/*; do
        name=$(basename "${interface}")
        if [[ ${name} != "lo" ]]; then
            echo "Disabling network interface ${name}"
            sudo ifconfig "${name}" down
        fi
    done

    sleep 1
    clear
    c_echo ''
    c_echo " This computer needs to be air gapped. The installer has "
    c_echo "disabled network interfaces as the first line of defense."
    c_echo ''
    c_echo "Disconnect the Ethernet cable and press any key to continue."
    read -r -n 1 -s -p ''
    echo -e '\n'
}


function add_serial_permissions {
    # Enable serial interface for user-level programs.
    clear
    c_echo ''
    c_echo "Setting serial permissions. If available, please connect the"
    c_echo "USB-to-serial/TTL adapter now and press any key to continue."
    read -r -n 1 -s -p ''
    echo -e '\n'
    sleep 3  # Wait for USB serial interfaces to register

    # Add user to the dialout group to allow serial access after reboot
    sudo adduser "${USER}" dialout

    # Add temporary permissions for serial interfaces until reboot
    arr=($(ls /sys/class/tty | grep USB)) || true
    for i in "${arr[@]}"; do
        sudo chmod 666 "/dev/${i}"
    done

    if [[ -e /dev/ttyS0 ]]; then
        sudo chmod 666 "/dev/ttyS0"
    fi
}


function create_user_data_dir {
    # Backup TFC user data directory if it exists and has files in it.
    if [[ -d "$HOME/tfc" ]]; then
        if [[ -n "$(ls -A "${HOME}/tfc/")" ]]; then
            mv "${HOME}/tfc" "${HOME}/tfc_userdata_backup_at_$(date +%Y-%m-%d_%H-%M-%S)"
        fi
    fi
    mkdir -p "${HOME}/tfc" 2>/dev/null
}


function get_screen_width {
    # Output the width of the screen resolution.
    xdpyinfo | grep dimensions | sed -r 's/^[^0-9]*([0-9]+).*$/\1/'
}


function modify_terminator_font_size {
    # Adjust terminator font size for tiling terminal emulator configurations.
    #
    # The default font sizes in terminator config file are for 1920px
    # wide screens. The lowest resolution (width) supported is 1366px.
    width=$(get_screen_width)

    if (( width < 1600 )); then
        $1 sed -i -e 's/font                = Monospace 11/font                = Monospace 8/g'     "${2}"  # Normal config
        $1 sed -i -e 's/font                = Monospace 10.5/font                = Monospace 7/g'   "${2}"  # Data diode config
    elif (( width < 1920 )); then
        $1 sed -i -e 's/font                = Monospace 11/font                = Monospace 9/g'     "${2}"  # Normal config
        $1 sed -i -e 's/font                = Monospace 10.5/font                = Monospace 8.5/g' "${2}"  # Data diode config
    fi
}


# Installation configurations for Debian/PureOS/Ubuntu/LMDE
# ----------------------------------------------------------------------------------------

function install_tcb {
    # Install TFC for Source/Destination Computer.
    steps_before_network_kill
    kill_network

    verify_files
    create_user_data_dir

    VENV_NAME="venv_tcb"

    install_packages_as_root "${virtualenv_packages[@]}"
    sudo python3 -m virtualenv "${INSTALL_DIR}/${VENV_NAME}" --system-site-packages --never-download --always-copy

    . ${INSTALL_DIR}/${VENV_NAME}/bin/activate
    install_to_venv "${tcb_packages[@]}"
    deactivate

    sudo mv ${INSTALL_DIR}/tfc.png                   /usr/share/pixmaps/
    sudo mv ${INSTALL_DIR}/launchers/TFC-TxP.desktop /usr/share/applications/
    sudo mv ${INSTALL_DIR}/launchers/TFC-RxP.desktop /usr/share/applications/

    # Remove unnecessary files
    remove_packages "${virtualenv_packages[@]}"
    remove_packages "${tcb_packages[@]}"
    remove_common_files "sudo"
    sudo rm -r "${INSTALL_DIR}/src/relay/"
    sudo rm -r "${INSTALL_DIR}/qubes/"
    sudo rm    "${INSTALL_DIR}/dd.py"
    sudo rm    "${INSTALL_DIR}/relay.py"
    sudo rm    "${INSTALL_DIR}/tfc.yml"

    add_serial_permissions

    install_complete "Installation of TFC on this device is now complete."
}


function install_relay {
    # Install TFC Relay configuration on Networked Computer.
    steps_before_network_kill

    verify_files
    create_user_data_dir

    VENV_NAME="venv_relay"

    install_virtualenv
    sudo python3 -m virtualenv ${INSTALL_DIR}/${VENV_NAME} --system-site-packages --always-copy

    . ${INSTALL_DIR}/${VENV_NAME}/bin/activate
    sudo torsocks ${INSTALL_DIR}/${VENV_NAME}/bin/pip3 install -r ${INSTALL_DIR}/requirements-relay.txt --require-hashes --no-deps
    deactivate

    sudo mv ${INSTALL_DIR}/tfc.png                  /usr/share/pixmaps/
    sudo mv ${INSTALL_DIR}/launchers/TFC-RP.desktop /usr/share/applications/

    # Remove unnecessary files
    remove_packages "${virtualenv_packages[@]}"
    remove_packages "${tcb_packages[@]}"
    remove_common_files "sudo"
    sudo rm -r "${INSTALL_DIR}/src/receiver/"
    sudo rm -r "${INSTALL_DIR}/src/transmitter/"
    sudo rm -r "${INSTALL_DIR}/qubes/"
    sudo rm    "${INSTALL_DIR}/dd.py"
    sudo rm    "${INSTALL_DIR}/tfc.py"
    sudo rm    "${INSTALL_DIR}/tfc.yml"

    add_serial_permissions

    install_complete "Installation of the TFC Relay configuration is now complete."
}


# ----------------------------------------------------------------------------------------
# Installation configuration for Tails

function read_sudo_pwd {
    # Cache the sudo password so that Debian doesn't keep asking
    # for it during the installation (it won't be stored on disk).
    read -r -s -p "[sudo] password for ${USER}: " sudo_pwd
    until (t_sudo echo '' 2>/dev/null)
    do
        echo -e '\nSorry, try again.'
        read -r -s -p "[sudo] password for ${USER}: " sudo_pwd
    done
    echo
}


function install_relay_tails {
    # Install TFC Relay configuration on Networked Computer
    # running Tails live distro (https://tails.boum.org/).
    read_sudo_pwd

    t_sudo apt update
    t_sudo apt install libssl-dev python3-pip python3-tk -y || true  # Ignore error in case packets can not be persistently installed

    create_user_data_dir

    VENV_NAME="venv_relay"

    torsocks git clone --depth 1 https://github.com/maqp/tfc.git "${HOME}/tfc"
    t_sudo mv "${HOME}/tfc/" "${INSTALL_DIR}/"
    t_sudo chown -R root ${INSTALL_DIR}/

    verify_tcb_requirements_files
    verify_files

    # Tails doesn't allow downloading over PIP to /opt/tfc, so we first download
    # to $HOME, move the files to /opt/tfc, and then perform the hash verification

    # Install prerequisites before downloading other packages: This ensures pip accepts manylinux2014 wheels
    torsocks python3 -m pip download -r "${INSTALL_DIR}/requirements-pre.txt"   --require-hashes --no-deps --no-cache-dir -d "${HOME}/"
    verify_packages "${pre_packages[@]}"
    install_packages_as_root "${pre_packages[@]}"

    torsocks python3 -m pip download -r "${INSTALL_DIR}/requirements-venv.txt"        --require-hashes --no-deps --no-cache-dir -d "${HOME}/"
    torsocks python3 -m pip download -r "${INSTALL_DIR}/requirements-relay-tails.txt" --require-hashes --no-deps --no-cache-dir -d "${HOME}/"

    verify_packages "${virtualenv_packages[@]}"
    verify_packages "${tails_packages[@]}"

    install_packages_as_root "${virtualenv_packages[@]}"

    # Install Relay Program dependencies to virtualenv
    t_sudo python3 -m virtualenv ${INSTALL_DIR}/${VENV_NAME} --system-site-packages --always-copy
    . ${INSTALL_DIR}/${VENV_NAME}/bin/activate
    install_to_venv "${tails_packages[@]}"
    deactivate

    t_sudo mv ${INSTALL_DIR}/tfc.png                        /usr/share/pixmaps/
    t_sudo mv ${INSTALL_DIR}/launchers/TFC-RP-Tails.desktop /usr/share/applications/
    t_sudo mv ${INSTALL_DIR}/tfc.yml                        /etc/onion-grater.d/

    # Remove unnecessary files
    remove_packages "${pre_packages[@]}"
    remove_packages "${virtualenv_packages[@]}"
    remove_packages "${tails_packages[@]}"
    remove_common_files "t_sudo"
    t_sudo rm -r "${INSTALL_DIR}/src/receiver/"
    t_sudo rm -r "${INSTALL_DIR}/src/transmitter/"
    t_sudo rm -r "${INSTALL_DIR}/qubes/"
    t_sudo rm    "${INSTALL_DIR}/dd.py"
    t_sudo rm    "${INSTALL_DIR}/tfc.py"

    install_complete "Installation of the TFC Relay configuration is now complete."
}


# ----------------------------------------------------------------------------------------
# Installation configurations for Qubes OS (https://www.qubes-os.org/)

function install_qubes_src {
    # Qubes Source VM installation configuration for Debian 10 domains.
    create_user_data_dir

    steps_before_network_kill

    VENV_NAME="venv_tcb"

    verify_files

    install_packages_as_root "${virtualenv_packages[@]}"
    sudo python3 -m virtualenv "${INSTALL_DIR}/${VENV_NAME}" --system-site-packages --never-download --always-copy

    . ${INSTALL_DIR}/${VENV_NAME}/bin/activate
    install_to_venv "${tcb_packages[@]}"
    deactivate

    sudo mv ${INSTALL_DIR}/tfc.png                         /usr/share/pixmaps/
    sudo mv ${INSTALL_DIR}/launchers/TFC-TxP-Qubes.desktop /usr/share/applications/
    sudo mv ${INSTALL_DIR}/launchers/tfc-qubes-transmitter /usr/bin/tfc-transmitter

    # Remove unnecessary files
    remove_packages "${virtualenv_packages[@]}"
    remove_packages "${tcb_packages[@]}"
    remove_common_files "sudo"
    sudo rm -r "${INSTALL_DIR}/src/relay/"
    sudo rm -r "${INSTALL_DIR}/qubes/"  # Listening service only needed on NET/DST
    sudo rm    "${INSTALL_DIR}/dd.py"
    sudo rm    "${INSTALL_DIR}/relay.py"
    sudo rm    "${INSTALL_DIR}/tfc.yml"

    install_complete_qubes
}


function install_qubes_dst {
    # Qubes Destination VM installation configuration for Debian 10 domains.
    create_user_data_dir

    steps_before_network_kill

    VENV_NAME="venv_tcb"

    verify_files

    # Configure listening service for qrexec RPC
    sudo ln -sf /opt/tfc/qubes/service.sh /etc/qubes-rpc/tfc.NetworkerDestination
    sudo chmod a+x /opt/tfc/qubes/writer.py
    sudo chmod a+x /opt/tfc/qubes/service.sh

    install_packages_as_root "${virtualenv_packages[@]}"
    sudo python3 -m virtualenv "${INSTALL_DIR}/${VENV_NAME}" --system-site-packages --never-download --always-copy

    . ${INSTALL_DIR}/${VENV_NAME}/bin/activate
    install_to_venv "${tcb_packages[@]}"
    deactivate

    sudo mv ${INSTALL_DIR}/tfc.png                         /usr/share/pixmaps/
    sudo mv ${INSTALL_DIR}/launchers/TFC-RxP-Qubes.desktop /usr/share/applications/
    sudo mv ${INSTALL_DIR}/launchers/tfc-qubes-receiver    /usr/bin/tfc-receiver

    # Remove unnecessary files
    remove_packages "${virtualenv_packages[@]}"
    remove_packages "${tcb_packages[@]}"
    remove_common_files "sudo"
    sudo rm -r "${INSTALL_DIR}/src/relay/"
    sudo rm    "${INSTALL_DIR}/dd.py"
    sudo rm    "${INSTALL_DIR}/relay.py"
    sudo rm    "${INSTALL_DIR}/tfc.yml"

    install_complete_qubes
}


function install_qubes_net {
    # Qubes Networked VM installation configuration for Debian 10 domains.
    create_user_data_dir

    steps_before_network_kill

    VENV_NAME="venv_relay"

    verify_files

    # Configure listening service for qrexec RPC
    sudo ln -sf /opt/tfc/qubes/service.sh /etc/qubes-rpc/tfc.SourceNetworker
    sudo chmod a+x /opt/tfc/qubes/writer.py
    sudo chmod a+x /opt/tfc/qubes/service.sh

    install_packages_as_root "${virtualenv_packages[@]}"
    sudo python3 -m virtualenv ${INSTALL_DIR}/${VENV_NAME} --system-site-packages --always-copy

    . ${INSTALL_DIR}/${VENV_NAME}/bin/activate
    sudo torsocks ${INSTALL_DIR}/${VENV_NAME}/bin/pip3 install -r ${INSTALL_DIR}/requirements-relay.txt --require-hashes --no-deps
    deactivate

    sudo mv ${INSTALL_DIR}/tfc.png                        /usr/share/pixmaps/
    sudo mv ${INSTALL_DIR}/launchers/TFC-RP-Qubes.desktop /usr/share/applications/
    sudo mv ${INSTALL_DIR}/launchers/tfc-qubes-relay      /usr/bin/tfc-relay

    # Remove unnecessary files
    remove_packages "${virtualenv_packages[@]}"
    remove_packages "${tcb_packages[@]}"
    remove_common_files "sudo"
    sudo rm -r "${INSTALL_DIR}/src/receiver/"
    sudo rm -r "${INSTALL_DIR}/src/transmitter/"
    sudo rm    "${INSTALL_DIR}/dd.py"
    sudo rm    "${INSTALL_DIR}/tfc.py"
    sudo rm    "${INSTALL_DIR}/tfc.yml"

    install_complete_qubes
}


# ----------------------------------------------------------------------------------------
# Tiling terminal emulator configurations for single OS

function install_local_test {
    # Install TFC for local testing on a single computer.
    steps_before_network_kill

    verify_files
    create_user_data_dir

    VENV_NAME="venv_tfc"

    sudo torsocks apt install terminator -y

    install_virtualenv
    sudo python3 -m virtualenv ${INSTALL_DIR}/${VENV_NAME} --system-site-packages --always-copy

    . ${INSTALL_DIR}/${VENV_NAME}/bin/activate
    sudo torsocks ${INSTALL_DIR}/${VENV_NAME}/bin/pip3 install -r ${INSTALL_DIR}/requirements.txt       --require-hashes --no-deps
    sudo torsocks ${INSTALL_DIR}/${VENV_NAME}/bin/pip3 install -r ${INSTALL_DIR}/requirements-relay.txt --require-hashes --no-deps
    deactivate

    sudo mv ${INSTALL_DIR}/tfc.png                                /usr/share/pixmaps/
    sudo mv ${INSTALL_DIR}/launchers/TFC-Local-test.desktop       /usr/share/applications/
    sudo mv ${INSTALL_DIR}/launchers/terminator-config-local-test ${INSTALL_DIR}/
    modify_terminator_font_size "sudo" "${INSTALL_DIR}/terminator-config-local-test"

    # Remove unnecessary files
    remove_packages "${virtualenv_packages[@]}"
    remove_packages "${tcb_packages[@]}"
    remove_common_files "sudo"
    sudo rm -r "${INSTALL_DIR}/qubes/"
    sudo rm    "${INSTALL_DIR}/tfc.yml"

    install_complete "Installation of TFC for local testing is now complete."
}


function install_developer {
    # Install TFC development configuration.
    #
    # This configuration will install TFC into `$HOME/tfc/`. This allows
    # you (the user) to easily make edits to the source between runs.
    # Note that it also means, that any malicious program with
    # user-level privileges is also able to modify the source files. For
    # more secure use on a single computer, select the local testing
    # install configuration, or preferably use the Qubes configuration.
    dpkg_check

    create_user_data_dir

    VENV_NAME="venv_tfc"

    sudo torsocks apt update
    sudo torsocks apt install git libssl-dev python3-pip python3-tk terminator -y

    torsocks git clone https://github.com/maqp/tfc.git "${HOME}/tfc"

    torsocks python3 -m pip install -r "${HOME}/tfc/requirements-venv.txt" --require-hashes --no-deps

    python3 -m virtualenv "${HOME}/tfc/${VENV_NAME}" --system-site-packages --always-copy

    . "${HOME}/tfc/${VENV_NAME}/bin/activate"
    torsocks ${HOME}/tfc/${VENV_NAME}/bin/pip3 install -r "${HOME}/tfc/requirements-dev.txt"
    deactivate

    sudo cp "${HOME}/tfc/tfc.png"                   "/usr/share/pixmaps/"
    sudo cp "${HOME}/tfc/launchers/TFC-Dev.desktop" "/usr/share/applications/"
    sudo sed -i "s|\$HOME|${HOME}|g"                "/usr/share/applications/TFC-Dev.desktop"
    modify_terminator_font_size "" "${HOME}/tfc/launchers/terminator-config-dev"
    chmod a+rwx -R "${HOME}/tfc/"

    # Remove unnecessary files
    sudo rm -f "/opt/install.sh"
    sudo rm -f "/opt/install.sh.asc"
    sudo rm -f "/opt/pubkey.asc"

    add_serial_permissions

    install_complete "Installation of the TFC dev environment is now complete."
}


function arg_error {
    # Print help message if the user launches the
    # installer with missing or invalid argument.
    clear
    echo -e "\nUsage: bash install.sh [OPTION]\n"
    echo    "Mandatory arguments"
    echo    "  tcb      Install Transmitter/Receiver Program (Debian 10 / PureOS 9.0+ / *buntu 20.04+ / LMDE 4 / Mint 20.2)"
    echo    "  relay    Install Relay Program                (Debian 10 / PureOS 9.0+ / *buntu 20.04+ / LMDE 4 / Mint 20.2 / Tails 4.20+)"
    echo -e "  local    Install insecure local testing mode  (Debian 10 / PureOS 9.0+ / *buntu 20.04+ / LMDE 4 / Mint 20.2)\n"
    echo    "  qsrc     Install Transmitter Program          (Qubes 4.0.4)"
    echo    "  qdst     Install Receiver Program             (Qubes 4.0.4)"
    echo -e "  qnet     Install Relay Program                (Qubes 4.0.4)\n"
    exit 1
}


# ----------------------------------------------------------------------------------------
# Pre-install checks

function architecture_check {
    # Check that the OS is 64-bit, and not 32-bit.
    if ! [[ "$(uname -m 2>/dev/null | grep x86_64)" ]]; then
        exit_with_message "Invalid system architecture. Only 64-bit OSs are supported"
    fi
}


function root_check {
    # Check that the installer was not launched as root.
    if [[ ! $EUID -ne 0 ]]; then
        exit_with_message "This installer must not be run as root."
    fi
}


function sudoer_check {
    # Check that the user who launched the installer is on the sudoers list.

    # Tails allows sudo without the user `amnesia` being on sudoers list.
    if ! [[ "$(lsb_release -a 2>/dev/null | grep Tails)" ]]; then
        return
    fi

    sudoers=$(getent group sudo |cut -d: -f4 | tr "," "\n")
    user_is_sudoer=false

    for sudoer in ${sudoers}; do
        if [[ ${sudoer} == ${USER} ]]; then
            user_is_sudoer=true
            break
        fi
    done

    if ! ${user_is_sudoer}; then
        exit_with_message "User ${USER} must be on the sudoers list."
    fi
}


function python_version_check {
    # Check Python version and select file names based on it.
    python_minor_version=$(python3 -c 'import sys; version=sys.version_info[:3]; print("{1}".format(*version))')
    supported_minor_versions=("7" "8" "9")

    if [[ ! "${supported_minor_versions[*]}" =~ ${python_minor_version} ]]; then
        exit_with_message "Invalid Python version (3.${python_minor_version}). Only 3.7, 3.8 and 3.9 are supported."
    fi

}


function test_installer {
    # Test that the installer's hashes match the files.
    # Note: This function is only used as part of the release pipeline.
    INSTALL_DIR='.'
    verify_tcb_requirements_files
    verify_files
}


# ----------------------------------------------------------------------------------------
# Main routine

set -e
architecture_check
root_check
sudoer_check
python_version_check
sudo_pwd=''

case $1 in
    tcb    ) install_tcb;;
    relay  ) install_relay;;
    tails  ) install_relay_tails;;
    local  ) install_local_test;;
    qsrc   ) install_qubes_src;;
    qdst   ) install_qubes_dst;;
    qnet   ) install_qubes_net;;
    dev    ) install_developer;;
    test   ) test_installer;;
    *      ) arg_error;;
esac
